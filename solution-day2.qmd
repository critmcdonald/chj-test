---
title: "Solutions Day 2"
---

## Goals

To learn about: arrange, filter, slice, group_by, summarize

To find several values from our data:

- The coldest and warmest days
- The rainiest and snowiest days
- Years with most snow days
- Years with most 100+ days
- Years with most rain
- Earliest day to reach 100+ each year

With this lesson we'll just use Texas data. (You theoretically could use a different state, but would need to adjust your code to import the right data, use valid cities, etc.)

## Setup

```{r}
#| label: setup
#| message: false

library(tidyverse)
```

## Import

```{r}
tx_clean <- read_rds("data-processed/tx_clean.rds")
```

## Arrange

Find the coldest day, warmest day, most snow, most rain.

### Coldest day

```{r}
tx_clean |> 
  arrange(tmin) |> 
  select(city, date, tmin)
```

### Hotest day

```{r}
tx_clean |> 
  arrange(desc(tmax)) |> 
  select(city, date, tmax)
```

### OYO: Most rain

Find the days with the most rain.

```{r}
tx_clean |> 
  arrange(desc(rain)) |> 
  select(city, date, rain)
```

### OYO: Most snow

Find the days with the most snow.

```{r}
tx_clean |> 
  arrange(desc(snow)) |> 
  select(city, date, snow)
```

## Filter

Find days that are 100+.

```{r}
tx_clean |> 
  filter(tmax >= 100)
```

Filter for days in Houston that are 100+

```{r}
tx_clean |> 
  filter(tmax >= 100, city == "Houston") |> 
  select(city, date, tmax)
```

Find days where it snowed, or there is snow still on the ground.

```{r}
tx_clean |> 
  filter(snow > 0 | snwd > 0) |> 
  select(city, date, snow, snwd)
```

### OYO: Snow days in Dallas

Find days where it snowed or there is snow on the ground, in Dallas.

```{r}
tx_clean |> 
  filter(snow > 0 | snwd > 0, city == "Dallas") |> 
  select(city, date, snow, snwd)
```

## Slice

Use slice_min to find the coldest day in our data.

```{r}
tx_clean |> 
  slice_min(tmin) |> 
  select(city, yr, tmin)
```

### OYO: Find the hottest day

```{r}
tx_clean |> 
  slice_max(tmax) |> 
  select(city, date, tmin, tmax)
```

## Group and slice

Add `group_by` to find the hottest day in each city.

```{r}
tx_clean |> 
  group_by(city) |> 
  slice_max(tmax)
```

### OYO: Coldest day in each city

```{r}
tx_clean |> 
  group_by(city) |> 
  slice_min(tmin)
```

### OYO: Hottest day each year in Austin

```{r}
tx_clean |> 
  group_by(yr) |> 
  slice_max(tmax) |> 
  select(city, tmax) |> 
  filter(city == "Austin")
  
```

## Group and Summarize: Count

Find the number of days in Austin that were 100+

```{r}
tx_clean |> 
  filter(city == "Austin", tmax >= 100) |> 
  group_by(yr) |> 
  summarize(hot_days = n()) |> 
  arrange(desc(hot_days))
```




Find the years with the most 100+ degree days in each city.

```{r}
tx_clean |> 
  filter(tmax >= 100) |> 
  group_by(city, yr) |> 
  summarize(hot_days = n()) |> 
  arrange(desc(hot_days))
  
```

### OYO: Most snow days by city each year

Count only the days that have some snow.

```{r}
tx_clean |> 
  filter(snow > 0) |> 
  group_by(city, yr) |> 
  summarise(snow_days = n()) |> 
  arrange(desc(snow_days))
```

## Group and Summarize: Math

Years with most rain in each city.

```{r}
tx_clean |> 
  group_by(city, yr) |> 
  summarize(total_rain = sum(rain)) |> 
  arrange(desc(total_rain))
```

### OYO: Years with most snow

Find the years with the most total snow in each city

```{r}
tx_clean |> 
  group_by(city, yr) |> 
  summarize(total_snow = sum(snow)) |> 
  arrange(desc(total_snow))

```

## Working through logic

Average rain per month in Austin.

```{r}
austin <- tx_clean |> filter(city == "Austin")

austin$date |> summary() 

austin |> 
  filter(yr > 1938, yr < 2023) |> 
  group_by(mn, yr) |> 
  summarize(mn_yr_rain = sum(rain)) |> 
  group_by(mn) |> 
  summarize(avg_mn_rain = mean(mn_yr_rain))
```

## Challenge: Earliest 100+ day each city

For each city, find the earliest day of a year in which it reached 100 degrees.

```{r}
tx_clean |> 
  filter(tmax >= 100) |> 
  group_by(city) |> 
  slice_min(yd) |> 
  select(city, date, tmax)
```
